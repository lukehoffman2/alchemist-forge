<!DOCTYPE html>
<html>
<head>
    <title>Medieval Forge (Solid Colors) - Three.js</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        // Scene setup
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x111111);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.outputEncoding = THREE.sRGBEncoding;

        document.body.appendChild(renderer.domElement);

        // Orbit Controls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.1;
        controls.screenSpacePanning = false;
        controls.maxPolarAngle = Math.PI / 1.9;

        // Lighting
        const hemisphereLight = new THREE.HemisphereLight(0x8899aa, 0x444444, 1.0);
        scene.add(hemisphereLight);

        const forgeLight = new THREE.PointLight(0xffaa33, 2, 100);
        forgeLight.position.set(0, 1.5, 0);
        forgeLight.castShadow = true;
        scene.add(forgeLight);
        
        // Increased intensity of fill lights to ensure walls are lit
        const fillLight1 = new THREE.PointLight(0x774411, 0.8, 25);
        fillLight1.position.set(8, 6, 8);
        scene.add(fillLight1);
        
        const fillLight2 = new THREE.PointLight(0x774411, 0.8, 25);
        fillLight2.position.set(-8, 6, 8);
        scene.add(fillLight2);

        // ======== MATERIAL CHANGES START ========

        // Removed all texture loaders. Using solid colors to guarantee visibility.
        const stoneMaterial = new THREE.MeshStandardMaterial({
            color: 0x888888, // Grey color for stone
            roughness: 0.8,
            metalness: 0.1
        });
        
        const woodMaterial = new THREE.MeshStandardMaterial({
             color: 0x8B4513, // Brown color for wood
             roughness: 0.8
        });

        const metalMaterial = new THREE.MeshStandardMaterial({ color: 0x333333, metalness: 0.9, roughness: 0.4 });
        
        const fireMaterial = new THREE.MeshBasicMaterial({ color: 0xffaa33 });
        
        // ======== MATERIAL CHANGES END ========

        // Forge Structure
        // Floor
        const floorGeometry = new THREE.PlaneGeometry(20, 20);
        const floor = new THREE.Mesh(floorGeometry, stoneMaterial);
        floor.rotation.x = -Math.PI / 2;
        floor.receiveShadow = true;
        scene.add(floor);

        // Walls
        const wallGeometry = new THREE.BoxGeometry(20, 8, 0.5);
        const backWall = new THREE.Mesh(wallGeometry, stoneMaterial);
        backWall.position.set(0, 4, -10);
        backWall.castShadow = true;
        backWall.receiveShadow = true;
        scene.add(backWall);

        const leftWall = new THREE.Mesh(wallGeometry, stoneMaterial);
        leftWall.rotation.y = Math.PI / 2;
        leftWall.position.set(-10, 4, 0);
        leftWall.castShadow = true;
        leftWall.receiveShadow = true;
        scene.add(leftWall);

        // Roof
        const roofGeometry = new THREE.PlaneGeometry(22, 22);
        const roof = new THREE.Mesh(roofGeometry, woodMaterial);
        roof.rotation.x = -Math.PI / 2;
        roof.position.y = 8;
        scene.add(roof);

        // Beams
        const beamGeometry = new THREE.BoxGeometry(0.5, 8, 0.5);
        const beam1 = new THREE.Mesh(beamGeometry, woodMaterial);
        beam1.position.set(-9.75, 4, 9.75);
        scene.add(beam1);

        const beam2 = new THREE.Mesh(beamGeometry, woodMaterial);
        beam2.position.set(9.75, 4, 9.75);
        scene.add(beam2);
        
        const beam3 = new THREE.Mesh(beamGeometry, woodMaterial);
        beam3.position.set(9.75, 4, -9.75);
        scene.add(beam3);

        // Forge
        const forgeBaseGeometry = new THREE.BoxGeometry(4, 1, 4);
        const forgeBase = new THREE.Mesh(forgeBaseGeometry, stoneMaterial);
        forgeBase.position.y = 0.5;
        forgeBase.castShadow = true;
        scene.add(forgeBase);

        const forgeFireGeometry = new THREE.BoxGeometry(2, 1, 2);
        const forgeFire = new THREE.Mesh(forgeFireGeometry, fireMaterial);
        forgeFire.position.y = 1.5;
        forgeFire.add(forgeLight); 
        scene.add(forgeFire);

        const chimneyGeometry = new THREE.CylinderGeometry(1, 1.5, 6, 8);
        const chimney = new THREE.Mesh(chimneyGeometry, stoneMaterial);
        chimney.position.set(0, 5, 0);
        chimney.castShadow = true;
        scene.add(chimney);

        // Anvil
        const anvilTopGeometry = new THREE.BoxGeometry(2, 0.5, 0.75);
        const anvilTop = new THREE.Mesh(anvilTopGeometry, metalMaterial);
        anvilTop.position.set(4, 1.25, 0);
        anvilTop.castShadow = true;
        scene.add(anvilTop);
        
        const anvilHornGeometry = new THREE.CylinderGeometry(0.25, 0.1, 1, 16);
        const anvilHorn = new THREE.Mesh(anvilHornGeometry, metalMaterial);
        anvilHorn.rotation.z = -Math.PI / 2;
        anvilHorn.position.set(5.5, 1.25, 0);
        anvilHorn.castShadow = true;
        scene.add(anvilHorn);

        const anvilBaseGeometry = new THREE.BoxGeometry(1, 1, 0.5);
        const anvilBase = new THREE.Mesh(anvilBaseGeometry, metalMaterial);
        anvilBase.position.set(4, 0.5, 0);
        anvilBase.castShadow = true;
        scene.add(anvilBase);

        // Camera Position
        camera.position.set(8, 6, 12);
        camera.lookAt(scene.position);

        // Animation Loop
        let flickerClock = new THREE.Clock();
        function animate() {
            requestAnimationFrame(animate);
            const delta = flickerClock.getDelta();

            // Flickering light effect
            const flickerSpeed = 5;
            const flickerStrength = 0.25;
            forgeLight.intensity = 2 + Math.sin(flickerClock.elapsedTime * flickerSpeed) * flickerStrength;

            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        // Handle window resizing
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }, false);

    </script>
</body>
</html>